<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ù‡∏∏‡πà‡∏ô PM2.5</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">

<style>
/* --- 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô --- */
body {
  font-family: 'Sarabun', sans-serif;
  background: #f5f5f5;
  margin: 0;
  padding: 20px;
}

.form-section {
  background: #fff;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 20px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.infographic { 
  text-align: center; 
}

h2 {
  background: linear-gradient(90deg, #4caf50, #ffeb3b, #ff9800, #f44336, #9c27b0);
  color: #000;
  /* ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô */
  font-size: 28px; 
  padding: 10px;
  border-radius: 8px;
  margin-top: 0px;
}

/* --- 2. ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© --- */
.header-group {
  display: flex;
  justify-content: center;
  align-items: flex-start; /* ‡∏ä‡∏¥‡∏î‡∏ö‡∏ô */
  gap: 4px;
  margin-top: -30px;
  margin-bottom: -20px;
}

.logo-hrh {
  height: 90px;
  width: auto;
}

.logo-occ {
  height: 130px;
  width: auto;
}

.header-text {
  margin-top: 20px; 
  text-align: left;
  /* ‚úÖ 2. ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• */
  font-size: 23px; 
  font-weight: bold;
  color: #4a148c;
  line-height: 1.3;
  max-width: 550px; 
  text-shadow: 1px 1px 0 #fff, -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff;
  white-space: nowrap; 
}

/* ‡∏ñ‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å ‡πÉ‡∏´‡πâ‡∏¢‡∏≠‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ */
@media (max-width: 600px) {
  .header-text {
    white-space: normal;
  }
}

/* --- 3. ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å (2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå) --- */
.main-content {
  display: flex;
  justify-content: space-between;
  align-items: stretch; /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏Ç‡∏ß‡∏≤‡∏™‡∏π‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ã‡πâ‡∏≤‡∏¢ */
  margin-top: 10px;
  gap: 15px;
}

.stations {
  width: 55%; 
  display: flex; 
  flex-direction: column;
}

.right-sidebar {
  width: 43%; 
  display: flex; 
  flex-direction: column; /* ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏ö‡∏ô‡∏•‡∏á‡∏•‡πà‡∏≤‡∏á */
  justify-content: flex-start; /* ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î */
  gap: 5px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏£‡∏π‡∏õ */
}

/* ‚úÖ 3. ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏°‡πà (Clinic/PM) ‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (5/8medthod) */
.right-sidebar .top-pic { 
  width: 100%;
  height: auto;
  border-radius: 8px;
  background: #ffffff;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  margin-bottom: 5px;
}

.method-container {
  display: flex;
  justify-content: space-between;
  gap: 5px;
  width: 100%;
  margin-top: 5px; /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ Clinic/PM ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
}

.method-container img {
  width: 48%; 
  height: auto;
  border-radius: 8px;
  /* ‚úÖ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏û‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å */
  box-shadow: 0 5px 15px rgba(0,0,0,0.4); 
  background: #ffffff; 
  border: 4px solid #f0f0f0; 
  object-fit: contain;
}

/* --- 4. ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ --- */
.station {
  margin: 0 0 15px 0;
  padding: 10px;
  border-radius: 10px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  color: #fff;
  width: 100%; 
  box-sizing: border-box;
}

.station-name {
  font-size: 20px;
  color: #000;
  font-weight: bold;
  margin-bottom: 5px;
  text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
}

.good { background: #2196f3; }
.moderate { background: #4caf50; color: #000; }
.unhealthy { background: #ffeb3b; color: #000; }
.very-unhealthy { background: #ff9800; }
.hazardous { background: #f44336; }

.pm-highlight {
  font-size: 26px;
  font-weight: bold;
  color: #0d47a1;
  background: #bbdefb;
  padding: 10px;
  border-radius: 8px;
  margin: 6px 0;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.level-highlight {
  font-size: 26px;
  font-weight: bold;
  /* ‚ùå ‡∏•‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î color: ... ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö */
  background: #ffcdd2;
  padding: 10px;
  border-radius: 8px;
  margin: 6px 0;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.emoji {
  font-size: 32px;
  line-height: 1.2;
  margin: 6px 0;
  text-align: center;
}

/* --- 5. ‡∏™‡πà‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î) --- */
#areaValue::before { content: "üìç "; font-size: 20px; }
#dateValue::before { content: "üìÖ "; font-size: 20px; }
#timeValue::before { content: "‚è∞ "; font-size: 20px; }

#areaValue, #dateValue, #timeValue {
  font-size: 22px; /* ‚úÖ ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå */
  font-weight: bold;
  color: #4a148c;
  background: #e1bee7;
  padding: 6px 12px; /* ‚úÖ ‡∏Ç‡∏¢‡∏≤‡∏¢ padding */
  border-radius: 6px;
  margin-bottom: 8px;
  display: inline-block;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* --- 6. ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (Advice Image) --- */
.advice-img {
  width: 100%; /* ‚úÖ ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á */
  max-width: 850px; 
  height: auto;
  margin: 15px auto;    
  border-radius: 10px;  
  box-shadow: 0 4px 8px rgba(0,0,0,0.1); 
  display: block;       
}

/* --- 7. ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4 --- */
.a4 {
  width: 210mm;
  min-height: 297mm;
  background-image: url('assets/bg_pm25.jpg');
  background-size: cover;
  background-position: center bottom;
  background-repeat: no-repeat;
  margin: 0 auto;
  padding: 10mm;
  box-sizing: border-box;
  position: relative;
}
button {
  padding: 10px 15px;
  margin-top: 10px;
  cursor: pointer;
  border: none;
  border-radius: 6px;
  font-size: 16px;
}
button:first-of-type { background: #2196f3; color: #fff; }
button:last-of-type { background: #4caf50; color: #fff; }

@media (max-width: 600px) {
  .station { font-size: 14px; }
  h2 { font-size: 18px; }
  
  .header-group {
    flex-direction: column;
    align-items: center;
    text-align: center;
  }
  .header-text {
    text-align: center;
    margin-top: 10px;
    white-space: normal; 
  }
  
  .main-content, .right-sidebar {
    flex-direction: column; 
  }
  .stations, .right-sidebar, .right-sidebar img {
    width: 100%;
  }
  .right-sidebar { gap: 10px; margin-top: 15px; }
  .method-container { flex-direction: column; }
  .method-container img { width: 100%; }
}
</style>
</head>
<body onload="setInitialValues()">

  <div class="form-section">
    <h2>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ù‡∏∏‡πà‡∏ô PM2.5</h2>
    
    <label>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: 
        <select id="areaSelector" onchange="toggleAreaInput()">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà --</option>
            <option value="‡∏ï.‡∏°‡∏≤‡∏ö‡∏ï‡∏≤‡∏û‡∏∏‡∏î/‡∏ï.‡∏´‡πâ‡∏ß‡∏¢‡πÇ‡∏õ‡πà‡∏á">‡∏ï.‡∏°‡∏≤‡∏ö‡∏ï‡∏≤‡∏û‡∏∏‡∏î/‡∏ï.‡∏´‡πâ‡∏ß‡∏¢‡πÇ‡∏õ‡πà‡∏á</option>
            <option value="manual">‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á</option>
        </select>
    </label><br><br>
    
    <div id="manualAreaContainer" style="display:none; margin-top: 5px;">
        <label>‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô: <input id="manualAreaInput" type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà"></label>
    </div>
    <br>
    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <input id="date" type="date"></label><br><br>
    <label>‡πÄ‡∏ß‡∏•‡∏≤: 
      ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á <input id="hour" type="number" min="0" max="23" style="width:60px"> 
      ‡∏ô‡∏≤‡∏ó‡∏µ <input id="minute" type="number" min="0" max="59" style="width:60px">
    </label>

    <h3>‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏û‡∏∑‡∏ä‡πÑ‡∏£‡πà ‡∏ï.‡∏´‡πâ‡∏ß‡∏¢‡πÇ‡∏õ‡πà‡∏á</h3>
    <label>‡∏Ñ‡πà‡∏≤ PM2.5: <input id="pm1" type="number" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç"></label><br><br>

    <h3>‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ ‡∏ï.‡∏°‡∏≤‡∏ö‡∏ï‡∏≤‡∏û‡∏∏‡∏î</h3>
    <label>‡∏Ñ‡πà‡∏≤ PM2.5: <input id="pm2" type="number" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç"></label><br><br>

    <button onclick="generateReport()">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button> 
    <button onclick="downloadImage()">üì∏ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏û</button> 
  </div>

  <div id="report" class="infographic a4" style="display:none;">
    
    <div class="header-group">
      <img src="assets/logo.hrh.png" alt="Logo HRH" class="logo-hrh">
      <img src="assets/logo.occ.png" alt="Logo OCC" class="logo-occ">
      <div class="header-text">
        ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏û‡∏£‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡πÄ‡∏ó‡∏û‡∏£‡∏±‡∏ï‡∏ô‡∏£‡∏≤‡∏ä‡∏™‡∏∏‡∏î‡∏≤‡∏Ø<br>
        ‡∏™‡∏¢‡∏≤‡∏°‡∏ö‡∏£‡∏°‡∏£‡∏≤‡∏ä‡∏Å‡∏∏‡∏°‡∏≤‡∏£‡∏µ ‡∏£‡∏∞‡∏¢‡∏≠‡∏á
      </div>
    </div>

    <h2>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ù‡∏∏‡πà‡∏ô PM <span style="font-size: 0.7em; vertical-align: sub;">2.5</span></h2>
    
    <div id="areaValue"></div>
    <div id="dateValue"></div>
    <div id="timeValue"></div>

    <div id="trendSummary"></div> 

    <div class="main-content">
      
      <div id="stations" class="stations"></div>

      <div class="right-sidebar">
          <div class="top-pic-container" style="display: flex; justify-content: space-between; gap: 5px; width: 100%;">
              <img src="assets/Clinic_pic.png" alt="Clinic Pic" class="top-pic" style="width: 49%;">
              <img src="assets/PM_pic.png" alt="PM Pic" class="top-pic" style="width: 49%;">
          </div>

          <div class="method-container">
              <img src="assets/5medthod.png" alt="5 ‡∏ß‡∏¥‡∏ò‡∏µ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô" style="margin-top: 0px;">
              <img src="assets/8medthod.png" alt="8 ‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏π‡πÅ‡∏•‡∏ï‡∏ô‡πÄ‡∏≠‡∏á" style="margin-top: 0px;">
          </div>
      </div>
    </div>

    <img src="assets/advice_table.jpg" alt="‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥" class="advice-img">
    
    <h3 style="margin-top: 16px; padding: 10px; background: #e1bee7; border-radius: 8px;">
        ‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡∏©‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏ä‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏≠‡∏≤‡∏ä‡∏µ‡∏ß‡πÄ‡∏ß‡∏ä‡∏Å‡∏£‡∏£‡∏°<br>
        ‡πÇ‡∏ó‡∏£ 038-684444 ‡∏ï‡πà‡∏≠ 3106 ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ 081-7810248
    </h3>
    
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <script>
    function toggleAreaInput() {
    const selector = document.getElementById("areaSelector");
    const container = document.getElementById("manualAreaContainer");
    
    if (selector.value === "manual") {
        container.style.display = "block";
    } else {
        container.style.display = "none";
        document.getElementById("manualAreaInput").value = ""; 
    }
}
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á Form
function setInitialValues() {
    // 1. ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Drop-down
    document.getElementById("areaSelector").value = "‡∏ï.‡∏°‡∏≤‡∏ö‡∏ï‡∏≤‡∏û‡∏∏‡∏î/‡∏ï.‡∏´‡πâ‡∏ß‡∏¢‡πÇ‡∏õ‡πà‡∏á";

    // 2. ‡πÄ‡∏ß‡∏•‡∏≤: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 08:00 ‡∏ô.
    document.getElementById("hour").value = "08";
    document.getElementById("minute").value = "00";

    // 3. ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
    const today = new Date();
    // ‡πÅ‡∏õ‡∏•‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö YYYY-MM-DD ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á type="date" ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0'); // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô 01-12
    const dd = String(today.getDate()).padStart(2, '0');      // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
    
    document.getElementById("date").value = `${yyyy}-${mm}-${dd}`;
}
// ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô getLevel(pm) ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
function getLevel(pm) {
    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (color) ‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (bgColor) ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö
    if (pm <= 15) return {text:"‡∏î‡∏µ‡∏°‡∏≤‡∏Å üòÉ", class:"good", color: "#0D47A1", bgColor: "#E3F2FD"}; // ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏°/‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ü‡πâ‡∏≤‡∏à‡∏≤‡∏á
    
    if (pm <= 25) return {text:"‡∏î‡∏µ üôÇ", class:"moderate", color: "#388E3C", bgColor: "#E8F5E9"}; // ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏°/‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏à‡∏≤‡∏á
    
    // 1. ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (Unhealthy) ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô
    if (pm <= 37.5) return {text:"‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á üòê", class:"unhealthy", color: "#FFC107", bgColor: "#FFF9C4"}; // ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏°/‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏à‡∏≤‡∏á
    
    if (pm <= 75) return {text:"‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û üò´", class:"very-unhealthy", color: "#E65100", bgColor: "#FFF3E0"}; // ‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÄ‡∏Ç‡πâ‡∏°/‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡πâ‡∏°‡∏à‡∏≤‡∏á
    
    // 2. ‡∏õ‡∏£‡∏±‡∏ö Emoji ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö '‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö' ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô üò° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ö emoji ‡∏ï‡∏±‡∏ß‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
    return {text:"‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û üò°", class:"hazardous", color: "#D32F2F", bgColor: "#FFEBEE"}; // ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏°/‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏î‡∏á‡∏à‡∏≤‡∏á
}
function generateReport() {
    let areaValue = document.getElementById("areaSelector").value;
    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á" ‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô
    if (areaValue === "manual") {
        areaValue = document.getElementById("manualAreaInput").value;
    }
    document.getElementById("areaValue").innerText = "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: " + areaValue;
    const dateInput = document.getElementById("date").value;
      if (dateInput) {
        const dateObj = new Date(dateInput);
        const days = ["‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå","‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå","‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£","‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò","‡∏ß‡∏±‡∏ô‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ","‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå","‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå"];
        const months = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô","‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô",
                        "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"];
        
        const dayName = days[dateObj.getDay()];
        const day = dateObj.getDate();
        const monthName = months[dateObj.getMonth()];
        const yearBE = dateObj.getFullYear() + 543;

        document.getElementById("dateValue").innerText = `${dayName} ‡∏ó‡∏µ‡πà ${day} ${monthName} ${yearBE}`;
      }

      const hour = document.getElementById("hour").value;
      const minute = document.getElementById("minute").value;
      if (hour !== "" && minute !== "") {
        document.getElementById("timeValue").innerText = `‡πÄ‡∏ß‡∏•‡∏≤: ${hour.padStart(2,'0')}:${minute.padStart(2,'0')} ‡∏ô.`;
      }

      const stationNames = [
        "‡∏à‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡∏±‡∏î:‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏û‡∏∑‡∏ä‡πÑ‡∏£‡πà ‡∏ï.‡∏´‡πâ‡∏ß‡∏¢‡πÇ‡∏õ‡πà‡∏á",
        "‡∏à‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡∏±‡∏î:‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ ‡∏ï.‡∏°‡∏≤‡∏ö‡∏ï‡∏≤‡∏û‡∏∏‡∏î"
      ];

      let stationsHTML = "";
      for (let i = 1; i <= 2; i++) {
        let name = stationNames[i - 1];
        let pm = parseFloat(document.getElementById("pm" + i).value);
        
        if (!isNaN(pm)) {
          let level = getLevel(pm);
          
          const emoji = level.text.match(/[\u{1F600}-\u{1F64F}]/u)?.[0] || "";
          const levelText = level.text.replace(emoji, "").trim();

          stationsHTML += `
            <div class="station ${level.class}">
              <div class="station-name">${name}</div>
              <div class="pm-highlight">‡∏Ñ‡πà‡∏≤ PM <span style="font-size: 0.7em; vertical-align: sub;">2.5</span>: ${pm} ¬µg/m¬≥</div>
              <div class="emoji">${emoji}</div>
              <div class="level-highlight" style="color: ${level.color}; background: ${level.bgColor};">‡∏£‡∏∞‡∏î‡∏±‡∏ö: ${levelText}</div>
            </div>`;
        }
      }

      document.getElementById("stations").innerHTML = stationsHTML;
      
      document.getElementById("report").style.display = "block";
    }

    function downloadImage() {
      const report = document.getElementById("report");
      html2canvas(report, { scale: 2 }).then(canvas => {
        const link = document.createElement("a");
        link.download = "pm25-report.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
      });
    }
  </script>
</body>
</html>





